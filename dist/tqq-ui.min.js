var dir=angular.module("tqq.ui",[]);
dir.factory("loading",function(){var e=!0;return{show:function(o){if(e){var d=document.createElement("section");d.className="load-box",document.body.style.overflowY="hidden",document.body.appendChild(d),document.getElementsByClassName("load-box")[0].innerHTML=' <div class="load-container"><div class="loader"></div></div>',e=!1}},hide:function(){var o=document.getElementsByClassName("load-box")[0];if(o)return document.body.removeChild(o),document.body.style.overflowY="auto",void(e=!0)}}});
dir.directive("tqqPagination",function(){function e(e,a,t,s){var n=[],i=Math.ceil(e/a),l=Math.ceil(t/2),g=Math.floor(t/2);if(i<=t)for(var r=1;r<=i;r++)n.push(r);else if(s<=l)for(var d=1;d<=t;d++)n.push(d);else if(s>l&&s+g<=i){var p=s-l+1,o=s-l+t;for(p;p<=o;p++)n.push(p)}else if(s>l&&s+g>i)for(var c=i-t+1;c<=i;c++)n.push(c);return n}function a(e,a){for(var t=[],s=Math.ceil(e/a),n=1;n<=s;n++)t.push(n);return t}return{restrict:"EA",replace:!0,scope:{totalItems:"=",maxSize:"=",itemsPerPage:"=",ngModel:"=",hideLast:"=",tqqChange:"&",itemSelectHide:"="},link:function(t,s,n,i){if(t.atrs=n,!n.ngModel)throw'"ng-model" is undefined \n 中文:"ng-model"为必传参数。';if(!n.itemsPerPage)throw'"items-per-page" is undefined \n 中文:"items-per-page"为必传参数。';if(!n.totalItems)throw'"total-items" is undefined \n 中文:"total-items"为必传参数。';var l,g,r;t.ngModel=t.ngModel||1,t.pageNum=Math.ceil(t.totalItems/(t.itemsPerPage||10)),t.pageArr=e(t.totalItems,t.itemsPerPage||10,t.maxSize||5,t.ngModel||1),t.allPageArr=a(t.totalItems,t.itemsPerPage||10),t.judge={first:"first",previous:"previous",next:"next",last:"last"},t.$watch("ngModel",function(a,s){l&&(t.pageArr=e(t.totalItems,t.itemsPerPage||10,t.maxSize||5,t.ngModel||1),t.tqqChange()),l=!0}),t.$watch("totalItems",function(s,n){s>0&&n>0&&(t.ngModel=1),g&&(t.pageArr=e(t.totalItems,t.itemsPerPage||10,t.maxSize||5,t.ngModel||1),t.allPageArr=a(t.totalItems,t.itemsPerPage||10),t.pageNum=Math.ceil(t.totalItems/(t.itemsPerPage||10))),g=!0}),t.$watch("itemsPerPage",function(){r&&(t.ngModel>1?t.ngModel=1:t.tqqChange(),t.pageArr=e(t.totalItems,t.itemsPerPage||10,t.maxSize||5,t.ngModel||1),t.allPageArr=a(t.totalItems,t.itemsPerPage||10),t.pageNum=Math.ceil(t.totalItems/(t.itemsPerPage||10))),r=!0}),t.updatePage=function(e){switch(e){case t.judge.first:t.ngModel=1;break;case t.judge.previous:t.ngModel>1&&t.ngModel--;break;case t.judge.next:t.ngModel<t.pageNum&&t.ngModel++;break;case t.judge.last:t.ngModel=t.pageNum;break;default:t.pageSelect=!1,t.ngModel=e}},t.updateItem=function(e){t.pageSelect=!1,t.itemsPerPage=e},t.updateShow=function(){t.pageSelect=!t.pageSelect},t.dismissSelect=function(){t.pageSelect=!1}},template:'<nav><div class="page-box" ng-if="pageSelect" ng-click="dismissSelect()"></div><ul class="pagination mg-none {{atrs.sizeClass}}"><li ng-if="!hideLast" ng-class="{disabled:ngModel===1}"><a href  ng-click="updatePage(judge.first)"><span ng-if="atrs.firstText">{{atrs.firstText}}</span><span  ng-if="!atrs.firstText"　class="anniu">&laquo;</span></a></li><li ng-class="{disabled:ngModel===1}"><a href  ng-click="updatePage(judge.previous)"><span ng-if="atrs.previousText">{{atrs.previousText}}</span><span  ng-if="!atrs.previousText"　class="anniu">&lsaquo;</span></a></li><li ng-repeat="val in pageArr track by $index" ng-class="{active:ngModel===val}"><a href ng-click="updatePage(val)">{{val}}</a></li><li ng-class="{disabled:ngModel===pageNum}"><a href  ng-click="updatePage(judge.next)"><span ng-if="atrs.nextText">{{atrs.nextText}}</span><span  ng-if="!atrs.nextText"　class="anniu">&rsaquo;</span></a></li><li ng-if="!hideLast" ng-class="{disabled:ngModel===pageNum}"><a href  ng-click="updatePage(judge.last)"><span ng-if="atrs.lastText">{{atrs.lastText}}</span><span  ng-if="!atrs.lastText"　class="anniu">&raquo;</span></a></li></ul><ul ng-if="!itemSelectHide" class="pagination pagination-init page-num-this {{atrs.sizeClass}}"><li><a href ng-click="updateShow()" ng-class="{active:pageSelect}">{{ngModel}}/{{pageNum}}</a><div class="page-list" ng-show="pageSelect"><div>每页显示</div><span ng-repeat="data in [10,20,50,100,200] track by $index" ng-class="{active:itemsPerPage===data}" ng-click="updateItem(data)">{{data}}</span><div>页&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp码</div><span ng-repeat="data in allPageArr track by $index" ng-class="{active:ngModel===data}" ng-click="updatePage(data)">{{data}}</span></div>'}});
dir.directive("tqqTable",function(){return{restrict:"EA",replace:!0,require:"?ngModel",scope:{tableData:"=",tableOptions:"=",tqqClick:"&",tableChecked:"="},link:function(e,t,l,a){e.$watch("tableData",function(e){if(e&&!angular.isArray(e))throw"table-data属性的值必须是一个数组"}),l.tableChecked&&(e.tableChecked=[],e.checkClick=function(){var t=[];e.tableData.length>0&&(e.allChecked||angular.forEach(e.tableData,function(e,l){t[l]=!0}),e.tableChecked=t)},e.$watch("tableChecked",function(t){if(e.tableData&&l.tableChecked){var i=0;angular.forEach(e.tableData,function(t,l){e.tableChecked[l]&&i++}),i==e.tableData.length?e.allChecked=!0:e.allChecked=!1,a&&a.$setViewValue({isAll:e.allChecked,isOne:1==i,isMany:i>0})}},!0)),e.tdClick=function(t,a,i){l.tqqClick&&e.tqqClick()(t,a,i),e.tableChecked&&(e.tableChecked[i]=!e.tableChecked[i])}},template:'<table> <thead> <tr> <th ng-repeat="data in tableOptions track by $index" ng-if="!data.defaultHide" ng-class="{checkedNo:!allChecked,checkedYes:allChecked}"><div ng-if="data.name !== \'@\'">{{data.name}}</div><div ng-if="data.name === \'@\'" class="checkCtrl pointer" ng-click="checkClick()"></div></th> </tr> </thead> <tbody> <tr ng-if="!tableData"><td style="height:300px;" valign="middle" colspan="{{tableOptions.length}}">加载中...</td></tr><tr ng-if="tableData.length==0"><td style="height:300px;" valign="middle" colspan="{{tableOptions.length}}">没有数据</td></tr><tr ng-repeat="(key,value) in tableData track by $index" class="pointer"  > <td ng-repeat="title in tableOptions track by $index" ng-class="{checkedNo:!tableChecked[key],checkedYes:tableChecked[key]}" ng-if="!title.defaultHide && !(title.field|tqqTableFieldIsArray)"><div class="{{title.class|tqqTableParse:value}}" ng-class = "{\'table-tr-hover\': title.isHover}" data-title = "{{title.isHover|tqqTableParse:value}}" ng-if="!title.isHtml && !(title.isHide|tqqTableParse:value)" ng-click="tdClick(value,title.judge,key)" ng-bind="title.field|tqqTableParse:value"></div><div class="{{title.class|tqqTableParse:value}}" ng-click="tdClick(value,title.judge,key)" ng-if="title.isHtml && !(title.isHide|tqqTableParse:value)" ng-class="{checkedNo:!tableChecked[key],checkedYes:tableChecked[key]}" ng-bind-html="title.field|tqqTableParse:value|toHtml"></div></td> <td ng-repeat="title in tableOptions track by $index" ng-if="!title.defaultHide && title.field|tqqTableFieldIsArray"><div ng-repeat=" child in title.field track by $index" ng-if="!child.isHtml && !(child.isHide|tqqTableParse:value)" ng-click="tdClick(value,child.judge,key)" class="{{child.class|tqqTableParse:value}}" ng-bind="child.field|tqqTableParse:value"></div><div ng-repeat=" child in title.field track by $index" ng-if="child.isHtml && !(child.isHide|tqqTableParse:value)" ng-click="tdClick(value,child.judge,key)" class="{{child.class|tqqTableParse:value}}" ng-bind-html="child.field|tqqTableParse:value|toHtml"></div></td> </tr> </tbody> </table> '}}).filter("tqqTableFieldIsArray",function(){return function(e){return angular.isArray(e)}}).filter("tqqTableParse",["$parse",function(e){return function(t,l){if(t)return"@"===t.substr(0,1)&&t.length>1?t.slice(1):"@"===t?'<div class="checkCtrl"></div>':e(t)(l)}}]).filter("toHtml",["$sce",function(e){return function(t){return e.trustAsHtml(t)}}]);